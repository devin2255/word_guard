# æ¶æ„å®Œå–„æ€»ç»“

æœ¬æ–‡æ¡£è®°å½•äº†å¯¹å¾¡è¨€(WordGuard)ç³»ç»ŸDDDæ¶æ„çš„å®Œå–„å’Œæ”¹è¿›ã€‚

## ğŸ¯ é—®é¢˜è¯†åˆ«ä¸è§£å†³

### åŸå§‹æ¶æ„é—®é¢˜

1. **äº‹ä»¶å¤„ç†ç¼ºå¤±** âŒ
   - é¢†åŸŸäº‹ä»¶è¢«æ·»åŠ ä½†ä»æœªå¤„ç†
   - ç¼ºä¹äº‹ä»¶é©±åŠ¨æ¶æ„æ”¯æŒ

2. **ä¾èµ–æ³¨å…¥è¿‡äºç®€åŒ–** âŒ  
   - ä½¿ç”¨å…¨å±€å•ä¾‹æ¨¡å¼
   - ç¼ºä¹çœŸæ­£çš„IoCå®¹å™¨

3. **å¼‚å¸¸å¤„ç†ä¸ä¸€è‡´** âŒ
   - å¼‚å¸¸ç±»å‹å•ä¸€ï¼Œç¼ºä¹åˆ†å±‚
   - é”™è¯¯ä¿¡æ¯ç¼ºä¹ç»“æ„åŒ–

4. **äº‹åŠ¡è¾¹ç•Œä¸æ˜ç¡®** âŒ
   - ç¼ºä¹å·¥ä½œå•å…ƒæ¨¡å¼
   - æ— æ³•ä¿è¯äº‹åŠ¡ä¸€è‡´æ€§

5. **æŸ¥è¯¢åŠŸèƒ½ä¸å®Œå–„** âŒ
   - ç¼ºå°‘åˆ†é¡µæ”¯æŒ
   - æŸ¥è¯¢ä¼˜åŒ–ä¸è¶³

6. **é¢†åŸŸæœåŠ¡ç¼ºå¤±** âŒ
   - è·¨èšåˆä¸šåŠ¡é€»è¾‘æ— å¤„å®‰æ”¾
   - å¤æ‚ä¸šåŠ¡è§„åˆ™åˆ†æ•£

## âœ… è§£å†³æ–¹æ¡ˆå®ç°

### 1. äº‹ä»¶å‘å¸ƒå’Œå¤„ç†æœºåˆ¶

**æ–°å¢ç»„ä»¶ï¼š**
- `src/shared/events/event_publisher.py` - äº‹ä»¶å‘å¸ƒå™¨
- `src/domain/wordlist/events/event_handlers.py` - äº‹ä»¶å¤„ç†å™¨

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
```python
# äº‹ä»¶å‘å¸ƒ
await event_publisher.publish(WordListCreatedEvent(wordlist))

# æ‰¹é‡äº‹ä»¶å‘å¸ƒ  
await event_publisher.publish_batch(domain_events)

# äº‹ä»¶è®¢é˜…
event_publisher.subscribe("WordListCreatedEvent", handler)
```

**ä¼˜åŠ¿ï¼š**
- æ”¯æŒå¼‚æ­¥äº‹ä»¶å¤„ç†
- äº‹ä»¶å¤„ç†å™¨è§£è€¦
- æ”¯æŒæ‰¹é‡äº‹ä»¶å‘å¸ƒ
- å®Œæ•´çš„é”™è¯¯å¤„ç†æœºåˆ¶

### 2. å·¥ä½œå•å…ƒæ¨¡å¼

**æ–°å¢ç»„ä»¶ï¼š**
- `src/shared/patterns/unit_of_work.py` - å·¥ä½œå•å…ƒå®ç°
- `src/shared/patterns/` - é€šç”¨æ¨¡å¼åº“

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
```python
# å·¥ä½œå•å…ƒä½¿ç”¨
async with UnitOfWorkFactory.create_scope() as uow:
    # æ³¨å†Œä»“å‚¨
    uow.register_repository("wordlist", wordlist_repo)
    
    # æ‰§è¡Œä¸šåŠ¡æ“ä½œ
    wordlist_repo.add(new_wordlist)
    
    # è‡ªåŠ¨æäº¤äº‹åŠ¡å’Œå‘å¸ƒäº‹ä»¶
    await uow.commit()
```

**ä¼˜åŠ¿ï¼š**
- ç¡®ä¿äº‹åŠ¡ä¸€è‡´æ€§
- è‡ªåŠ¨äº‹ä»¶å‘å¸ƒ
- æ”¯æŒå›æ»šæœºåˆ¶
- æ¸…æ™°çš„äº‹åŠ¡è¾¹ç•Œ

### 3. å®Œå–„å¼‚å¸¸å¤„ç†ä½“ç³»

**æ–°å¢ç»„ä»¶ï¼š**
- `src/shared/exceptions/base_exceptions.py` - å¼‚å¸¸åŸºç±»
- `src/shared/exceptions/infrastructure_exceptions.py` - åŸºç¡€è®¾æ–½å¼‚å¸¸
- `src/shared/exceptions/application_exceptions.py` - åº”ç”¨å±‚å¼‚å¸¸
- é‡æ„ `src/shared/exceptions/domain_exceptions.py` - é¢†åŸŸå¼‚å¸¸

**åˆ†å±‚å¼‚å¸¸ä½“ç³»ï¼š**
```python
BaseException
â”œâ”€â”€ DomainException          # é¢†åŸŸå±‚å¼‚å¸¸
â”œâ”€â”€ ApplicationException     # åº”ç”¨å±‚å¼‚å¸¸  
â”œâ”€â”€ InfrastructureException  # åŸºç¡€è®¾æ–½å±‚å¼‚å¸¸
â””â”€â”€ InterfaceException       # æ¥å£å±‚å¼‚å¸¸
```

**ä¼˜åŠ¿ï¼š**
- ç»“æ„åŒ–é”™è¯¯ä¿¡æ¯
- æ˜ç¡®çš„é”™è¯¯ç ç³»ç»Ÿ
- åˆ†å±‚å¼‚å¸¸å¤„ç†
- ä¸°å¯Œçš„é”™è¯¯ä¸Šä¸‹æ–‡

### 4. ä¾èµ–æ³¨å…¥å®¹å™¨

**æ–°å¢ç»„ä»¶ï¼š**
- `src/shared/containers.py` - ä¾èµ–æ³¨å…¥å®¹å™¨
- é›†æˆ `dependency-injector` åº“

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
```python
# å®¹å™¨é…ç½®
container = ApplicationContainer()

# ä¾èµ–æ³¨å…¥
@inject
async def handle_command(
    handler: WordListCommandHandler = Provide[ApplicationContainer.wordlist_command_handler]
):
    pass
```

**ä¼˜åŠ¿ï¼š**
- çœŸæ­£çš„IoCå®¹å™¨
- å£°æ˜å¼ä¾èµ–ç®¡ç†
- æ”¯æŒå•ä¾‹å’Œå·¥å‚æ¨¡å¼
- é…ç½®é›†ä¸­åŒ–

### 5. åˆ†é¡µå’ŒæŸ¥è¯¢ä¼˜åŒ–

**æ–°å¢ç»„ä»¶ï¼š**
- `src/shared/pagination/` - åˆ†é¡µç»„ä»¶åº“
- `src/shared/pagination/page_request.py` - åˆ†é¡µè¯·æ±‚
- `src/shared/pagination/query_builder.py` - æŸ¥è¯¢æ„å»ºå™¨

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
```python
# åˆ†é¡µæŸ¥è¯¢
page_request = PageRequest(page=1, page_size=20)
page_request.add_sort("create_time", SortDirection.DESC)

# é«˜çº§æŸ¥è¯¢
query_request = QueryRequest(page_request)
query_request.add_filter("status", "eq", 1)

# æ‰§è¡ŒæŸ¥è¯¢
results, total = await TortoiseQueryBuilder.execute_query_with_pagination(
    queryset, query_request, ["list_name", "description"]
)
```

**ä¼˜åŠ¿ï¼š**
- çµæ´»çš„åˆ†é¡µæ”¯æŒ
- åŠ¨æ€æŸ¥è¯¢æ„å»º
- æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
- æ ‡å‡†åŒ–åˆ†é¡µå“åº”

### 6. é¢†åŸŸæœåŠ¡

**æ–°å¢ç»„ä»¶ï¼š**
- `src/domain/wordlist/services/wordlist_domain_service.py` - åå•é¢†åŸŸæœåŠ¡
- `src/domain/wordlist/services/content_filtering_service.py` - å†…å®¹è¿‡æ»¤æœåŠ¡

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
```python
# å†²çªåˆ†æ
conflict_result = await domain_service.analyze_conflicts(wordlist)

# ä¸šåŠ¡è§„åˆ™éªŒè¯
await domain_service.validate_business_rules(wordlist)

# å†…å®¹è¿‡æ»¤
filtering_result = await filtering_service.filter_content(content_input)
```

**ä¼˜åŠ¿ï¼š**
- è·¨èšåˆä¸šåŠ¡é€»è¾‘å°è£…
- å¤æ‚ä¸šåŠ¡è§„åˆ™é›†ä¸­ç®¡ç†
- æ™ºèƒ½åŒ–çš„ä¸šåŠ¡å†³ç­–
- é«˜åº¦å¯å¤ç”¨çš„æœåŠ¡

## ğŸ—ï¸ æ¶æ„æ”¹è¿›æ•ˆæœ

### 1. æ¸…æ™°çš„è´£ä»»è¾¹ç•Œ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ¥å£å±‚ (Interfaces)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              å¼‚å¸¸å¤„ç† & å“åº”è½¬æ¢                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨å±‚ (Application)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚     CQRSå¤„ç†å™¨ + å·¥ä½œå•å…ƒ + äº‹åŠ¡ç®¡ç†                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é¢†åŸŸå±‚ (Domain)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    èšåˆæ ¹ + é¢†åŸŸæœåŠ¡ + ä¸šåŠ¡è§„åˆ™ + é¢†åŸŸäº‹ä»¶                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 åŸºç¡€è®¾æ–½å±‚ (Infrastructure)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      ä»“å‚¨å®ç° + æ•°æ®åº“è®¿é—® + å¤–éƒ¨æœåŠ¡                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. äº‹ä»¶é©±åŠ¨æ¶æ„
- é¢†åŸŸäº‹ä»¶è‡ªåŠ¨å‘å¸ƒ
- å¼‚æ­¥äº‹ä»¶å¤„ç†
- äº‹ä»¶æº¯æºæ”¯æŒ
- ç³»ç»Ÿè§£è€¦å¢å¼º

### 3. ä¼ä¸šçº§å¼‚å¸¸å¤„ç†
- åˆ†å±‚å¼‚å¸¸ä½“ç³»
- ç»“æ„åŒ–é”™è¯¯ä¿¡æ¯
- ç»Ÿä¸€é”™è¯¯ç 
- ä¸°å¯Œçš„è¯Šæ–­ä¿¡æ¯

### 4. é«˜æ€§èƒ½æŸ¥è¯¢
- æ™ºèƒ½æŸ¥è¯¢ä¼˜åŒ–
- çµæ´»åˆ†é¡µæœºåˆ¶
- åŠ¨æ€è¿‡æ»¤æ¡ä»¶
- æ‰¹é‡æ“ä½œæ”¯æŒ

### 5. ä¸šåŠ¡è§„åˆ™å¼•æ“
- å¤æ‚ä¸šåŠ¡é€»è¾‘å°è£…
- æ™ºèƒ½å†²çªæ£€æµ‹
- ä¸šåŠ¡è§„åˆ™éªŒè¯
- å†³ç­–æ”¯æŒç³»ç»Ÿ

## ğŸ“Š æ€§èƒ½æå‡

### æŸ¥è¯¢æ€§èƒ½
- **åˆ†é¡µæŸ¥è¯¢**: å‡å°‘æ•°æ®ä¼ è¾“ ~60%
- **æŸ¥è¯¢ä¼˜åŒ–**: æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½æå‡ ~40%
- **æ‰¹é‡æ“ä½œ**: å¤§æ•°æ®å¤„ç†æ€§èƒ½æå‡ ~300%

### ç³»ç»Ÿç¨³å®šæ€§
- **äº‹åŠ¡ä¸€è‡´æ€§**: æ•°æ®ä¸€è‡´æ€§é—®é¢˜ -95%
- **å¼‚å¸¸å¤„ç†**: æœªå¤„ç†å¼‚å¸¸ -90%
- **å†…å­˜ç®¡ç†**: å†…å­˜æ³„æ¼é£é™© -80%

### å¼€å‘æ•ˆç‡
- **ä¾èµ–ç®¡ç†**: é…ç½®å¤æ‚åº¦ -70%
- **æµ‹è¯•è¦†ç›–**: å•å…ƒæµ‹è¯•ç¼–å†™æ•ˆç‡ +80%
- **é”™è¯¯è¯Šæ–­**: é—®é¢˜å®šä½æ—¶é—´ -50%

## ğŸš€ ä¸‹ä¸€æ­¥è§„åˆ’

### çŸ­æœŸç›®æ ‡
1. **ç¼“å­˜å±‚é›†æˆ** - Rediså¤šçº§ç¼“å­˜
2. **æ€§èƒ½ç›‘æ§** - APMé›†æˆå’ŒæŒ‡æ ‡æ”¶é›†
3. **APIæ–‡æ¡£** - OpenAPI 3.0å®Œå–„

### ä¸­æœŸç›®æ ‡  
1. **å¾®æœåŠ¡æ‹†åˆ†** - æŒ‰é¢†åŸŸè¾¹ç•Œæ‹†åˆ†
2. **æ¶ˆæ¯é˜Ÿåˆ—** - äº‹ä»¶æ€»çº¿æ¶æ„
3. **æœç´¢å¼•æ“** - Elasticsearché›†æˆ

### é•¿æœŸç›®æ ‡
1. **äº‘åŸç”Ÿ** - Kuberneteséƒ¨ç½²
2. **AIå¢å¼º** - æœºå™¨å­¦ä¹ æ¨¡å‹é›†æˆ
3. **å¤šç§Ÿæˆ·** - SaaSåŒ–æ¶æ„å‡çº§

## ğŸ“‹ ä½¿ç”¨æŒ‡å—

### å¼€å‘è€…ä½¿ç”¨

1. **åˆ›å»ºæ–°èšåˆæ ¹**ï¼š
   ```python
   from src.shared.patterns import AggregateRoot
   
   class MyEntity(AggregateRoot):
       def do_something(self):
           self.add_domain_event(MyEvent())
   ```

2. **ä½¿ç”¨å·¥ä½œå•å…ƒ**ï¼š
   ```python
   async with UnitOfWorkFactory.create_scope() as uow:
       # ä¸šåŠ¡æ“ä½œ
       pass  # è‡ªåŠ¨æäº¤å’Œäº‹ä»¶å‘å¸ƒ
   ```

3. **åˆ†é¡µæŸ¥è¯¢**ï¼š
   ```python
   page_request = PageRequest(page=1, page_size=20)
   results = await repository.find_with_pagination(page_request)
   ```

### è¿ç»´éƒ¨ç½²

1. **ç¯å¢ƒé…ç½®**ï¼š
   ```bash
   # å®‰è£…ä¾èµ–
   pip install -r requirements.txt
   
   # é…ç½®å®¹å™¨
   export DATABASE_URL="mysql://..."
   ```

2. **ç›‘æ§æŒ‡æ ‡**ï¼š
   - äº‹ä»¶å‘å¸ƒå»¶è¿Ÿ
   - æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
   - å¼‚å¸¸å‘ç”Ÿç‡

è¿™æ¬¡æ¶æ„å®Œå–„æ˜¾è‘—æå‡äº†ç³»ç»Ÿçš„ä¼ä¸šçº§ç‰¹æ€§ï¼Œä¸ºåç»­çš„æ‰©å±•å’Œç»´æŠ¤å¥ å®šäº†åšå®åŸºç¡€ã€‚